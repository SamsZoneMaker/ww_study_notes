# *wAPI* Exanples 开发记录

## CCP 协议

### test_main.c

#### `#define ccp_dump`

* 作用是在  `data` 数据区间（从开始的位置），按字节读取数据并以十六进制格式打印出来。每个字节的格式是 `0xXX,`，其中 `XX` 是该字节的十六进制表示。
* 循环从 `0` 到 `len-1`，通过 `*(uint8_t*)((data) + z)` 获取数据区间中每个字节的值。
* `data` 是指向数据的指针，`len` 是数据的长度

**宏定义中使用 `do...while(0)` 的原因：**
宏在预处理的时候会被展开，宏里的多行代码可能只会执行其中的一行，而直接用`{}` 括起来无法编译通过，所以使用循环可以将多行代码囊括在内。

**内联函数**
宏的内容本身就是个函数式的表达，但是与函数不同的是通过宏替换将函数体嵌入到调用的位置，其本质依然是程序的文本替换。

#### `const void *data`

**`const`**：这是一个修饰符，表示指针所指向的对象是常量，不允许通过该指针修改其所指向的内容。也就是说，`data` 指向的内存位置的数据是只读的。

**`void`**：`void` 是一种特殊的数据类型，表示“无类型”。在这里，它表示 `data` 是一个指向未知类型数据的指针。`void` 指针是一个通用指针，可以指向任何类型的数据，但不能直接解引用，需要先转换为实际类型的指针才能使用。

**`*data`**：这是一个指针声明，意味着 `data` 是一个指针，指向某个地址。

**常见使用场景：**
这种类型的指针经常出现在一些需要处理不同类型数据的函数中，或者用于处理二进制数据（例如，内存中的字节流）。

#### `union linebuf`

定义了一个名为 `linebuf` 的联合体

`uint32_t ui[MAX_BYTES/sizeof(uint32_t) + 1];` 中定义了一个无符号的 32 位整数类型（通常用于存储 4 字节的整数值），其中 `ui` 是联合体的一个成员，是一个数组；

`sizeof(uint32_t)` 返回一个 `uint32_t` 类型所占的字节数，通常是 4 字节。因此，`MAX_BYTES / sizeof(uint32_t)` 计算的是可以容纳多少个 `uint32_t` 类型的元素，而 `+1` 是为了在最后再多留一个位置，可能是为了保证数组的大小能够容纳所有数据或者处理某种特殊情况。

最后的 `lb`这是声明一个名为`lb` 的 `linebuf` 类型变量，它是这个联合体类型的一个实例。

